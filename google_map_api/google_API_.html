<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forest Fire Management</title>
    <style>
        #map {
            height: 400px;
            width: 100%;
        }
        #search-bar {
            margin-top: 10px;
            padding: 5px;
            width: 300px;
        }
        #parameters-box {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            width: 300px;
        }
    </style>
</head>
<body>
    <h1>Forest Fire Management</h1>
    <input id="search-bar" type="text" placeholder="Search location...">
    <button id="search-button">Search</button>
    <div id="map"></div>
    <div id="parameters-box"></div>

    <script>
        var map;
        var marker = null;

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 0, lng: 0},
                zoom: 3
            });

            // Add search bar functionality
            var input = document.getElementById('search-bar');
            var searchBox = new google.maps.places.SearchBox(input);
            map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

            // Bias the SearchBox results towards current map's viewport
            map.addListener('bounds_changed', function() {
                searchBox.setBounds(map.getBounds());
            });

            // Add search button functionality
            document.getElementById('search-button').addEventListener('click', function() {
                var place = searchBox.getPlaces()[0];
                if (place) {
                    map.setCenter(place.geometry.location);
                    map.setZoom(12); // Adjust zoom level as needed
                }
            });

            map.addListener('click', function(e) {
                var lat = e.latLng.lat();
                var lng = e.latLng.lng();

                // Remove previous marker if exists
                if (marker) {
                    marker.setMap(null);
                }

                // Add marker at the clicked location
                marker = new google.maps.Marker({
                    position: {lat: lat, lng: lng},
                    map: map,
                    icon: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png' // Red dot icon
                });

                // Call function to get weather data
                getWeatherAPI(lat, lng);
            });
        }

        function getWeatherAPI(lat, lng) {
            // Example of using OpenWeatherMap API to get elevation data
            var apiKey = `bbb3159788f1fc3f1a33340159b846f7`;
            var url = `https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lng}&appid=${apiKey}&units=imperial`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    // Log the response data for debugging
                    console.log('Response data:', data);

                    // Extract temperature from data
                    var temperature = data.list[0].main.temp;
                    var min_temp = data.list[0].main.temp_min;
                    var max_temp = data.list[0].main.temp_max;
                    var humidity = data.list[0].main.humidity;
                    var pressure = data.list[0].main.pressure;
                    var wind_speed = data.list[0].wind.speed;
                    var wind_direction = data.list[0].wind.deg;
                    var population = data.city.population;
                    var elevation = data.list[0].main.sea_level;

                    // Update parameters box content with temperature
                    var parametersBox = document.getElementById('parameters-box');
                    parametersBox.innerHTML = `
                        <p>Longitude : ${lng }</p>
                        <p>Latitude : ${lat }</p>
                        <!-- <p>Temperature: ${temperature}째F</p>
                        <p>Min Temperature: ${min_temp}째F</p>
                        <p>Max Temperature: ${max_temp}째F</p>
                        <p>Humidity: ${humidity}%</p>
                        <p>Pressure: ${pressure} hPa</p>
                        <p>Wind Speed: ${wind_speed} m/s</p>
                        <p>Wind Direction: ${wind_direction}째</p>
                        <p>Population: ${population}</p>
                        <p>Elevation : ${elevation }</p> -->
                    `;
                })
                .catch(error => console.error('Error fetching data:', error));
        }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDxwUgU9kfjU_tcist3jDQ3LjSouV5m3h8&libraries=places&callback=initMap"></script>
</body>
</html>
